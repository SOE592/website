---
title: "Simulating and fitting time series"
subtitle: "SOE 592 â€“ Intro to Time Series Analysis"
date: "<br>3 Jan 2024"
output:
  html_document:
    theme: sandstone
    highlight: textmate
    css: ["lecture_inst.css", "fontawesome.css", "solid.css"]
    toc: true
    toc_float: true
    toc_depth: 3
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  fig.dim = c(7, 5)
  )
```

# Introduction

One of the best ways to learn about how models work is to simulate data and then try to recover the parameters of interest. In this lab we'll simulate data from some of the simple time series models we discuss earlier, and then use some other functions to plot them and investigate their properties.

***

# White noise

Recall that a time series $\{w_t\}$ is discrete white noise if its values are

1. independent  

2. identically distributed with a mean of zero

In this course we will focus exclusively on _Gaussian white noise_, whereby

$$
w_t \sim \text{N}(0,\sigma^2)
$$

## Simulating white noise

Drawing random numbers from a statistical distribution in R is straightforward. For the normal (Gaussian) distribution, the function is `rnorm()`. Note that we will typically refer to the variance of a distribution rather than the standard deviation (SD), so be careful to use the correct value when specifying the form of the distribution.

<div class="boxy boxy-orange boxy-lightbulb">
**Tip:** Type `?rnorm` at the command prompt to see all of the options for `rnorm()`.
</div>


```{r sim_white_noise}
## set the seed for the random number generator so we all get the same results
set.seed(592)

## length of the time series
nn <- 100

## set the variance = 2 --> SD = sqrt(2)
sigma <- sqrt(2)

## draw random values
wt <- rnorm(n = nn, mean = 0, sd = sigma)
```

## Plotting a time series

We can use the base function `plot.ts()` to plot a time series by passing only the vector of values without the need to specify both the `x` and `y` arguments for a typical x-y plot. The actual syntax is a bit odd because you specify `x = values` when actually $x$ is the time index (i.e., length of the time series) and $y$ are the values to plot.

```{r plot_white_noise}
## plot the time series of white noise
plot.ts(x = wt, ylab = expression(italic(w[t])))
```

<div class="boxy boxy-orange boxy-lightbulb">
**Tip:** You can use pipe operators with `plot.ts()` just as you would for any other function, independent of whether it comes from the {tidyverse} package.
</div>

```{r plot_white_noise_pipe, eval = FALSE}
## plot.ts via the native pipe operator |>
wt |> plot.ts(ylab = expression(italic(w[t])))

## plot.ts via the {tidyverse} pipe operator %>%
wt %>% plot.ts(ylab = expression(italic(w[t])))
```

***

# Autocorrelation function

Recall from lecture that we can estimate the correlation of a time series with a lagged (shifted) version of itself via the _autocorrelation function_ (ACF). If a time series is white noise, the ACF should equal zero for all non-zero lags.

We can estimate the ACF with the base function `acf()`, which will consider lags up to 20 by default.

<div class="boxy boxy-orange boxy-lightbulb">
**Tip:** Type `?acf` at the command prompt to see all of the options for `acf()`, including how to set the maximum number of lags via the `lag.max` argument.
</div>

```{r acf_white_noise}
## estimate and plot the ACF
acf(x = wt)
```

<div class="boxy boxy-red boxy-exclamation">
**Note:** The autocorrelation at a lag of 0 equals 1 because it's the correlation of a time series with itself.
</div>

<br>

**Q**: What's going on at lag = 5 where it looks like the correlation is below the dashed blue line indicating it's significantly negative?

**A**: Here we're basing the statistical significance on a Type-I error of 5% (i.e., $\alpha$ = 0.05), which means we should expect a spurious significant correlation about 1 in 20 times. In this case, we were simply (un)lucky.

<br>

<div class="boxy boxy-blue boxy-clipboard-list">
**Task:** Increase the length of the simulated time series with `n = 1000` and estimate the ACF. Do you see significant autocorrelation at any lags?
</div>


***

# Random walks



***

# Biased random walks



***

# Autoregressive models



***

# Partial autocorrelation


